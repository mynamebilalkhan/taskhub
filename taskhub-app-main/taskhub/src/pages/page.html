<link rel="stylesheet" href="../css/page.css">
<script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
<div class="page-content-wrapper">
  <!-- Message display -->
  <div id="page-message" class="page-message hidden"></div>

  <!-- Unified Content (No Tabs) -->
  <div class="unified-content">
    <!-- TASK TABLE SECTION -->
    <div class="task-table-wrapper hidden" id="task-table-wrapper">
      <div class="card-header">
        <h3>Tasks</h3>
        <div class="card-actions">
          <button class="add-column"><strong>+ Add Column</strong></button>
          <button class="settings-btn"><img src="assets/images/gear-icon.png" /></button>
        </div>
      </div>
      <table class="task-table">
        <thead>
          <tr>
            <th data-column="title">Name <span class="sort-arrow"><img src="assets/images/arrow-down.svg"
                  class="arrow-down" /></span></th>
            <th data-column="industry">Industry <span class="sort-arrow"><img src="assets/images/arrow-down.svg"
                  class="arrow-down" /></span></th>
            <th data-column="createdByName">Author <span class="sort-arrow"><img src="assets/images/arrow-down.svg"
                  class="arrow-down" /></span></th>
            <th data-column="createdDateTime">Created <span class="sort-arrow"><img src="assets/images/arrow-down.svg"
                  class="arrow-down" /></span></th>
            <th data-column="lastModifyDateTime">Edited <span class="sort-arrow"><img src="assets/images/arrow-down.svg"
                  class="arrow-down" /></span></th>
            <th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="add-task-btn hidden">
        <button id="add-task-btn"><strong>+ Add Row</strong></button>
      </div>

      <div class="task-context-menu hidden" id="task-context-menu">
        <button data-action="update">Update</button>
        <button data-action="add-subtask">Add Subtask</button>
        <button data-action="add-workspace">Add Workspace</button>
        <button data-action="add-taskFavourite">Mark as Favourite</button>
        <button data-action="remove-taskFavourite" class="hidden">Remove from Favourite</button>
        <button data-action="add-taskPinned">Mark as Pinned</button>
        <button data-action="remove-taskPinned" class="hidden">Remove from Pinned</button>
        <button data-action="delete"
          style="color: #dc3545; border-top: 1px solid #e5e7eb; margin-top: 5px; padding-top: 5px;">Delete Task</button>
      </div>
    </div>

    <!-- CARDS SECTION -->
    <div class="cards-section">
      <div class="cards-header">
        <h3>Cards</h3>
      </div>
      <div id="cards-grid" class="task-grid"></div>
    </div>

    <!-- PAGE BLOCKS CONTAINER (Notes and Images) -->
    <div id="page-blocks-container" class="page-blocks-container"></div>
    
    <!-- Floating Action Button for Cards -->
    <div class="fab-container">
      <button class="fab-button" id="add-card-fab" title="Add Card">
        <span>+</span>
      </button>
    </div>
  </div>

  <!-- Loading overlay -->
  <div id="page-loading-overlay" class="page-loading-overlay hidden">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading...</div>
    </div>
  </div>

  <!-- TASK MODALS -->
  <div class="modal-overlay hidden" id="add-task-modal">
    <div class="modal">
      <h3>Add New Task</h3>
      <input type="text" id="task-title" placeholder="Title">
      <textarea id="task-description" placeholder="Description"></textarea>
      <input type="date" id="task-due-date" placeholder="Due Date">
      <input type="text" id="task-status" placeholder="Status">
      <input type="text" id="task-priority" placeholder="Priority">
      <select id="task-assigned-id">
        <option value="" disabled selected>Assigned To</option>
      </select>
      <input type="text" id="task-industry" placeholder="Industry">

      <div class="modal-actions">
        <button id="save-task-btn">Save</button>
        <button id="cancel-task-btn">Cancel</button>
      </div>
    </div>
  </div>

  <!-- COLUMN SELECTOR MODAL -->
  <div class="modal-overlay hidden" id="column-selector-modal">
    <div class="modal">
      <h3>Select Columns to Display</h3>
      <div id="column-checkboxes" style="max-height: 300px; overflow-y: auto;">
        <!-- Checkboxes will be dynamically added here -->
      </div>
      <div class="modal-actions">
        <button id="cancel-columns-btn">Clear all</button>
        <button id="apply-columns-btn">Save as new view</button>
      </div>
    </div>
  </div>

  <!-- UPDATE TASK MODAL -->
  <div class="modal-overlay hidden" id="update-task-modal">
    <div class="modal">
      <h3>Update Task</h3>
      <input type="hidden" id="update-task-id">
      <input type="text" id="update-task-title" placeholder="Title">
      <textarea id="update-task-description" placeholder="Description"></textarea>
      <input type="date" id="update-task-due-date" placeholder="Due Date">
      <input type="text" id="update-task-status" placeholder="Status">
      <input type="text" id="update-task-priority" placeholder="Priority">
      <select id="update-task-assigned-id">
        <option value="" disabled selected>Assigned To</option>
      </select>
      <input type="text" id="update-task-industry" placeholder="Industry">

      <div class="modal-actions">
        <button id="update-task-save-btn">Update</button>
        <button id="update-task-cancel-btn">Cancel</button>
      </div>
    </div>
  </div>

  <!-- CARD MODALS -->
  <div class="modal-overlay hidden" id="add-card-modal">
    <div class="modal">
      <h3>Add New Card</h3>
      <input type="text" id="card-title" placeholder="Title">
      <textarea id="card-description" placeholder="Description"></textarea>

      <select id="card-status">
        <option value="todo">To Do</option>
        <option value="inprogress">In Progress</option>
        <option value="done">Done</option>
      </select>

      <input type="text" id="card-priority" placeholder="Priority">
      <input type="text" id="card-category" placeholder="Category">

      <select id="card-assigned-to">
        <option value="" disabled selected>Assigned To</option>
        <!-- user options will be filled here -->
      </select>

      <input type="date" id="card-due-date">

      <div class="modal-actions">
        <button id="save-card-btn">Save</button>
        <button id="cancel-card-btn">Cancel</button>
      </div>
    </div>
  </div>

  <!-- UPDATE CARD MODAL -->
  <div class="modal-overlay hidden" id="update-card-modal">
    <div class="modal">
      <h3>Update Card</h3>
      <input type="hidden" id="update-card-id">
      <input type="text" id="update-card-title" placeholder="Title">
      <textarea id="update-card-description" placeholder="Description"></textarea>

      <select id="update-card-status">
        <option value="todo">To Do</option>
        <option value="inprogress">In Progress</option>
        <option value="done">Done</option>
      </select>

      <input type="text" id="update-card-priority" placeholder="Priority">
      <input type="text" id="update-card-category" placeholder="Category">

      <select id="update-card-assigned-to">
        <option value="" disabled selected>Assigned To</option>
        <!-- user options will be filled here -->
      </select>

      <input type="date" id="update-card-due-date">

      <div class="modal-actions">
        <button id="update-card-save-btn">Update</button>
        <button id="update-card-cancel-btn">Cancel</button>
      </div>
    </div>
  </div>

  <!-- CARD CONTEXT MENU -->
  <div id="card-context-menu" class="context-menu hidden">
    <button id="linkto" data-action="link-to">Link to</button>
    <button id="card-workspace" data-action="add-workspace">Add Workspace</button>
    <button id="update-card" data-action="update-card">Update</button>
    <button id="delete-card" data-action="delete-card">Delete</button>
  </div>

  <!-- CUSTOM MODALS -->
  <div id="custom-modal-task-workspace" class="modal-overlay hidden">
    <div class="modal">
      <h2 id="modal-title-task-workspace">Enter a value</h2>
      <label id="modal-label-task-workspace" for="modal-input">Label:</label>
      <input type="text" id="modal-input-task-workspace" class="modal-input" />
      <textarea id="modal-textarea-task-workspace" class="modal-textarea hidden" rows="6"></textarea>
      <div class="modal-buttons">
        <button id="modal-cancel-btn-task-workspace">Cancel</button>
        <button id="modal-ok-btn-task-workspace">OK</button>
      </div>
    </div>
  </div>

  <div id="custom-modal-card-workspace" class="modal-overlay hidden">
    <div class="modal">
      <h2 id="modal-title-card-workspace">Enter a value</h2>
      <label id="modal-label-card-workspace" for="modal-input">Label:</label>
      <input type="text" id="modal-input-card-workspace" class="modal-input" />
      <textarea id="modal-textarea-card-workspace" class="modal-textarea hidden" rows="6"></textarea>
      <div class="modal-buttons">
        <button id="modal-cancel-btn-card-workspace">Cancel</button>
        <button id="modal-ok-btn-card-workspace">OK</button>
      </div>
    </div>
  </div>

  <!-- Delete Note Confirmation Modal -->
  <div id="delete-note-confirmation-modal" class="modal-overlay hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Delete Note</h2>
        <button id="delete-note-confirmation-close-btn" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this note? This action cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button id="delete-note-confirmation-cancel-btn" class="btn-secondary">Cancel</button>
        <button id="delete-note-confirmation-delete-btn" class="btn-danger">Delete</button>
      </div>
    </div>
  </div>

  <!-- Delete Image Confirmation Modal -->
  <div id="delete-image-confirmation-modal" class="modal-overlay hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Delete Image</h2>
        <button id="delete-image-confirmation-close-btn" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this image? This action cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button id="delete-image-confirmation-cancel-btn" class="btn-secondary">Cancel</button>
        <button id="delete-image-confirmation-delete-btn" class="btn-danger">Delete</button>
      </div>
    </div>
  </div>
</div>